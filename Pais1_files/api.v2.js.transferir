(()=>{function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function t(t){for(var n=1;n<arguments.length;n++){var a=null!=arguments[n]?arguments[n]:{};n%2?e(Object(a),!0).forEach((function(e){i(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):e(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function n(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(){window.pandascripttag=window.pandascripttag||[];for(var e=0;e<window.pandascripttag.length;e++)window.pandascripttag[e]();window.pandascripttag.length=0}window.PANDA_ORIGIN="*",window.PandaPlayer=function(){function e(t,n){var a=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),i(this,"paused",!1),i(this,"audio",!0),i(this,"muted",!1),i(this,"pip",!1),i(this,"volume",1),i(this,"captions",{}),i(this,"currentTime",0),i(this,"iframe",null),i(this,"duration",0),i(this,"fullscreen",!1),i(this,"ready",!1),i(this,"video_external_id",""),i(this,"live_id",""),i(this,"video_hls",""),i(this,"element_id",""),i(this,"speed",{options:[],selected:1}),i(this,"_callbackQueue",[]),i(this,"colors",{primaryColor:"",captionsColor:"",captionsBackgroundColor:"",controlsColor:"",menuColor:""}),i(this,"callbacks",[]),i(this,"library_id",""),i(this,"captureMessage",(function(e){var t=e.data;if(t.video===a.video_external_id){if("panda_error"===t.message&&a.onError&&a.onError(t),"panda_allData"===t.message){if(!t&&!t.playerData)return;a.paused=t.playerData.paused,a.audio=t.playerData.hasAudio,a.muted=t.playerData.muted,a.pip=t.playerData.pip,a.volume=t.playerData.volume,a.captions=t.playerData.captions,a.currentTime=t.playerData.currentTime,a.duration=t.playerData.duration,a.fullscreen=t.playerData.fullscreen,a.colors=t.playerData.colors,a.speed=t.playerData.speed,a.ready||0===a.duration||(a.ready=!0,a.onReady&&a.onReady(),a._callbackQueue.forEach((function(e){return e()})),a._callbackQueue=[])}a.callbacks.forEach((function(e){return e(t)}))}})),this._onCreate(t,n)}var a,r;return a=e,(r=[{key:"_onCreate",value:function(e,t){var n=this;t&&t.onError&&(this.onError=t.onError),t&&t.onReady&&(this.onReady=t.onReady);var i=document.getElementById(e);if(!i){for(var a=e.replace("panda-",""),r=document.getElementsByTagName("iframe"),o=0;o<r.length;o++)r[o].src&&new RegExp("".concat(a)).test(r[o].src)&&(r[o].id=e,i=r[o]);if(!i)return console.error("PandaPlayer: element not found"),void(this.onError&&this.onError((function(){return new Error("PandaPlayer: element not found")})))}if("IFRAME"!==i.tagName||i.src){if("DIV"===i.tagName){var s="";if(!t)return void console.error("PandaPlayer: options is required");var l=t.playerConfigs,c=t.video_id,d=t.library_id,u=t.defaultStyle,p=t.video_external_id,f=t.url;if(l)for(var y=0,h=Object.keys(l);y<h.length;y++){var v=h[y];s+="&".concat(v,"=").concat(l[v])}var m=function(){var e,t="";n.video_external_id?(e=n.video_external_id,t=n.library_id):(e=n.live_id,t=n.video_hls.split("https://b-")[1].split(".tv")[0],s+="&isLive=true"),u?(i.style.cssText="position:relative;padding-top:56.25%;",i.innerHTML='\n          <iframe id="panda-'.concat(e,'" style="border:none;position:absolute;top:0;height:100%;width:100%" src="https://player-').concat(t,".tv.pandavideo.com.br/embed/?v=").concat(e).concat(s,'" allow="accelerometer;gyroscope;autoplay;encrypted-media;picture-in-picture" allowfullscreen=true></iframe>\n          ')):i.innerHTML='\n          <iframe id="panda-'.concat(e,'" src="https://player-').concat(t,".tv.pandavideo.com.br/embed/?v=").concat(e).concat(s,'" allow="accelerometer;gyroscope;autoplay;encrypted-media;picture-in-picture" allowfullscreen=true></iframe>\n          '),i.querySelector("iframe").onload=function(){n.iframe=i.querySelector("iframe").contentWindow,window.addEventListener("message",n.captureMessage,!1)}};if(f)fetch("https://api-v2.pandavideo.com/oembed?url="+encodeURIComponent(f)).then((function(e){if(200===e.status)return e.json();throw new Error("PandaPlayer: invalid url")})).then((function(e){var t=e.video_external_id,i=e.pullzone_name,a=e.live_id,r=e.video_hls;n.video_hls=r,n.live_id=a,n.video_external_id=t,n.library_id=i,m()}));else{if(p)this.video_external_id=p;else{if(!c)return void console.error("PandaPlayer: video_external_id is required");this.video_external_id=c}if(!d)return void console.error("PandaPlayer: library_id is required");this.library_id=d,m()}}else if("IFRAME"===i.tagName&&i.src){this.iframe=document.getElementById(e).contentWindow;var w=new URL(document.getElementById(e).src);this.video_external_id=w.searchParams.get("v");var g=w.searchParams.get("l");this.library_id=g||w.hostname.split(".tv")[0].split("player-")[1],window.addEventListener("message",this.captureMessage,!1)}}else i.addEventListener("load",(function(){n._onCreate(e,t)}))}},{key:"loadWindowScreen",value:function(e){var t=e.panda_id_player,n=!1,i=0,a=0,r=0,o=function(){var e=document.getElementById(t);i||(i=e.height?e.height:e.style.height),a||(a=e.width?e.width:e.style.width),r||(r=e.style.zIndex),e.style.height=window.innerHeight+"px",e.style.width=window.innerWidth+"px",e.style.position="fixed",e.style.overflow="hidden",e.style.left=0,e.style.zIndex=999999,document.body.style.overflow="hidden",n=!0},s=function(){var e=document.getElementById(t);e.style.height=i?i.match(/%/)?i:i+"px":"100%",e.style.width=a?a.match(/%/)?a:a+"px":"100%",e.style.position="absolute",e.style.zIndex=r,document.body.style.overflow="inherit",n=!1};this.onEvent((function(e){"panda_open_window_fullscreen"==e.message?o():"panda_close_window_fullscreen"==e.message&&s()})),document.onkeydown=function(e){27==(e=e||window.event).keyCode&&n&&s()},window.addEventListener("resize",(function(){n&&o()}))}},{key:"loadButtonInTime",value:function(e){var n=this,i=e.time,a=e.divId,r=e.script,o=e.fetchApi,s=e.duration;if(o){var l="https://config.tv.pandavideo.com.br/".concat(this.library_id,"/").concat(this.video_external_id,".json?date=").concat((new Date).getTime());fetch(l).then((function(e){return e.json()})).then((function(e){e.outsideCta&&e.outsideCta.forEach((function(e){n.loadButtonInTime(t(t({},e),{},{time:parseInt(""+e.time,10)}))}))}))}else if(a){if(!document.getElementById(a))return;this.onEvent((function(e){if("panda_timeupdate"===e.message){var t=e.currentTime;if(e.isMutedIndicator)return;var o=document.getElementById(a),l=document.getElementById("".concat(a,"_iframe"));try{s=parseInt(s+"",10)}catch(e){s=0}if(isNaN(i)&&(i=0),0===s&&(s=n.duration+1),t>=i&&t<i+s&&o&&!l){var c=document.createElement("iframe");c.style="border:0;width:100%;height:100%",c.id="".concat(a,"_iframe"),c.onload=function(){var e=document.getElementById("".concat(a,"_iframe")),t=/<script>(.|\n)*?<\/script>/gm,n=r.match(t),i=r.replace(t,"");if(n&&n.length){var o=n[0].replace("<script>","").replace("<\/script>",""),s=document.createElement("script");s.type="text/javascript",s.innerHTML=o,e.contentWindow.document.body.innerHTML="".concat(i),e.contentWindow.document.body.appendChild(s)}else e.contentWindow.document.body.innerHTML="".concat(i);e.contentWindow.document.body.style="padding:0;margin:0"},o.appendChild(c)}else if(t<i||t>i+s){var d=document.getElementById("".concat(a,"_iframe"));d&&d.remove()}}}))}}},{key:"_setEvent",value:function(e){this.ready?e():this._callbackQueue.push(e)}},{key:"destroy",value:function(){var e=document.getElementById(this.element_id);"DIV"===e.tagName?document.getElementById(this.element_id).innerHTML="":e.remove(),this.callbacks=[],window.removeEventListener("message",this.captureMessage)}},{key:"getColors",value:function(){return this.colors}},{key:"getSpeed",value:function(){return this.speed}},{key:"setSpeed",value:function(e){var t=this;this._setEvent((function(){t.iframe.postMessage({type:"speed",parameter:e},window.PANDA_ORIGIN),t.speed.selected=e}))}},{key:"setColor",value:function(e,t){var n=this;this._setEvent((function(){n.iframe.postMessage({type:"colors",parameter:{colors:i({},e,t)}},window.PANDA_ORIGIN),n.colors[e]=t}))}},{key:"getCurrentTime",value:function(){return this.currentTime}},{key:"getDuration",value:function(){return this.duration}},{key:"isFullscreen",value:function(){return this.fullscreen}},{key:"getVolume",value:function(){return this.volume}},{key:"isPaused",value:function(){return this.paused}},{key:"isMuted",value:function(){return this.muted}},{key:"isPIP",value:function(){return this.pip}},{key:"hasAudio",value:function(){return this.hasAudio}},{key:"play",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"play"},window.PANDA_ORIGIN),e.isPaused=!1}))}},{key:"pause",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"pause"},window.PANDA_ORIGIN),e.isPaused=!0}))}},{key:"togglePlay",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"togglePlay"},window.PANDA_ORIGIN),e.isPaused=!e.isPaused}))}},{key:"showControls",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"enable_all_controls"},window.PANDA_ORIGIN)}))}},{key:"hideControls",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"disable_all_controls"},window.PANDA_ORIGIN)}))}},{key:"toggleFullscreen",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"fullscreen.toggle"},window.PANDA_ORIGIN),e.fullscreen=!e.fullscreen}))}},{key:"exitFullscreen",value:function(){var e=this;this._setEvent((function(){e.iframe.postMessage({type:"fullscreen.exit"},window.PANDA_ORIGIN),e.fullscreen=!1}))}},{key:"setCurrentTime",value:function(e){var t=this;this._setEvent((function(){t.iframe.postMessage({type:"currentTime",parameter:e},window.PANDA_ORIGIN),t.currentTime=e}))}},{key:"setVolume",value:function(e){var t=this;this._setEvent((function(){t.iframe.postMessage({type:"volume",parameter:e},window.PANDA_ORIGIN),t.volume=e}))}},{key:"getCaptions",value:function(){return this.captions}},{key:"onEvent",value:function(e){this.callbacks.push(e)}}])&&n(a.prototype,r),Object.defineProperty(a,"prototype",{writable:!1}),e}(),window.pandascripttag=window.pandascripttag||[],0!==window.pandascripttag.length&&a(),window.pandascripttag.push=function(){Array.prototype.push.apply(this,arguments),a()}})();